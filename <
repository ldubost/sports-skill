import json, requests, urllib
from mycroft import MycroftSkill, intent_file_handler
from mycroft.util.log import getLogger

baseurl = "http://localhost:8080/xwiki/bin/get/Players/ViewResults/JSON?outputSyntax=plain"

LOGGER = getLogger(__name__)

class Sports(MycroftSkill):
    def __init__(self):
        MycroftSkill.__init__(self)

    @intent_file_handler('sports.intent')
    def handle_sports(self, message):
        LOGGER.info(message.data.get("player", "nadal"))
        url = baseurl + "&player=" + urllib.parse.quote(message.data.get("player" , "nadal")) 
        LOGGER.info("URL: " + url)
        resp = requests.get(url=url)
        data = resp.json()
        LOGGER.info("XX" + data + "YY")
        str = data.results.text
        self.speak(str)


def create_skill():
    return Sports()

